## ----setup, include=FALSE----------------------------------------------------------------------------------------------------------------------------------------
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)


## ----------------------------------------------------------------------------------------------------------------------------------------------------------------
salary<-read.table("http://www.isi-stats.com/isi2/data/Wages.txt",header=T)
salary.dat<-salary%>%mutate(wage=wage/100)


## ----------------------------------------------------------------------------------------------------------------------------------------------------------------
levels(salary.dat$educ)
gr.means=salary.dat%>%group_by(educ,race)%>%summarize(mean.salary=mean(wage))



## ----eval=FALSE--------------------------------------------------------------------------------------------------------------------------------------------------
## gr.means$educ<-factor(gr.means$educ,levels=c("belowHS","HS","college","beyondCollege"))
## gr.means %>% ggplot(aes(x=educ,y=mean.salary,color=race))+
##   geom_line(aes(group=race),lwd=2)+geom_point()


## ----------------------------------------------------------------------------------------------------------------------------------------------------------------
contrasts(salary.dat$race)=contr.sum
contrasts(salary.dat$educ)=contr.sum
inter.lm<-lm(wage~race*educ,data=salary.dat)
coef(inter.lm)


## ----------------------------------------------------------------------------------------------------------------------------------------------------------------
library(car)
Anova(inter.lm,type=3)


## ----------------------------------------------------------------------------------------------------------------------------------------------------------------
 no.inter.lm<-lm(wage~race+educ,data=salary.dat)
Anova(no.inter.lm,type=3)


## ----------------------------------------------------------------------------------------------------------------------------------------------------------------
pair.diff<-TukeyHSD(aov(wage~race*educ,data=salary.dat))
pair.diff$`race:educ`[20:25,]


## ----------------------------------------------------------------------------------------------------------------------------------------------------------------
pair.diff2<-TukeyHSD(aov(wage~race+educ,data=salary.dat))
pair.diff2

