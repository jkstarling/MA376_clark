## ----setup, include=FALSE--------------------------------------------------------------------------------------------------------------------
knitr::opts_chunk$set(echo = TRUE,fig.width=5,fig.height=3)
library(tidyverse)


## --------------------------------------------------------------------------------------------------------------------------------------------
house.dat<-read.table("http://www.isi-stats.com/isi2/data/housing.txt",header=T)
house.dat<- house.dat %>% mutate(price=price.1000)%>% select(-price.1000)
sqft.lm<-lm(price~sqft,data=house.dat)
summary(sqft.lm)
anova(sqft.lm)



## --------------------------------------------------------------------------------------------------------------------------------------------
fit.house <- house.dat %>% mutate(resids=sqft.lm$residuals,preds=sqft.lm$fitted.values)
fit.house %>% ggplot(aes(x=preds,y=resids,color=lake))+geom_point()


## --------------------------------------------------------------------------------------------------------------------------------------------
fit.house %>% group_by(lake)%>%summarize(mean=mean(resids))


## --------------------------------------------------------------------------------------------------------------------------------------------
fit.house %>% group_by(lake)%>%summarize(mean=mean(sqft))


## --------------------------------------------------------------------------------------------------------------------------------------------
contrasts(house.dat$lake)=contr.sum
lake.lm<-lm(price~lake,data=house.dat)
coef(lake.lm)


## --------------------------------------------------------------------------------------------------------------------------------------------
house.dat.mod<-house.dat%>%mutate(price=ifelse(lake=="lakefront",price-197.2,price+197.2))

mod.lm<-lm(price~sqft,data=house.dat.mod)
coef(mod.lm)


## --------------------------------------------------------------------------------------------------------------------------------------------
house.dat.mod<-house.dat%>%mutate(lake.adj.price=lake.lm$residuals)
mod.lm<-lm(lake.adj.price~sqft,data=house.dat.mod)
coef(mod.lm)


## --------------------------------------------------------------------------------------------------------------------------------------------
library(car)
full.lm<-lm(price~lake+sqft,house.dat)
avPlots(full.lm)


## --------------------------------------------------------------------------------------------------------------------------------------------
summary(full.lm)


## --------------------------------------------------------------------------------------------------------------------------------------------
Anova(full.lm,type=2)


## --------------------------------------------------------------------------------------------------------------------------------------------
par(mfrow=c(1,2))
plot(full.lm,which=c(1:2))

